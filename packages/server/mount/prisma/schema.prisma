// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "linux-arm64-openssl-1.1.x", "debian-openssl-1.1.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
  id        Int @id @default(autoincrement())
  clerk_id  String @unique()
  username  String?
}

// NHL Models
model Team {
  id              Int @id
  name            String
  link            String
  abbreviation    String
  teamName        String
  franchise       Franchise?
  conference      Conference? @relation(fields: [conferenceId], references: [id])
  conferenceId    Int?
  division        Division?  @relation(fields: [divisionId], references: [id] )
  divisionId      Int?
  // venue           Venue @relation(fields: [venueId], references: [id])
  // venueId        Int
  locationName    String
  firstYearOfPlay String
  officialSiteUrl String
  active          Boolean
  playoffSeries   TeamsInSeries[]
}

model Conference {
  id              Int @id
  name            String
  link            String
  abbreviation    String
  shortName       String
  active          Boolean
  division        Division[]
  teams           Team[]
}

model Division { 
  id              Int @id
  name            String
  nameShort       String
  link            String
  abbreviation    String
  conference      Conference @relation(fields: [conferenceId], references: [id])
  conferenceId    Int
  teams           Team[]
}

model Franchise {
  id                  Int @id
  firstSeasonId       Int
  lastSeasonId        Int?
  team                Team? @relation(fields: [mostRecentTeamId], references: [id])
  mostRecentTeamId    Int @unique
  link                String
}

model Series {
  round       Int
  season      String
  seriesCode  String
  teams       TeamsInSeries[]
  @@id([season, round, seriesCode])
}

model TeamsInSeries {
  team Team? @relation(fields: [teamId], references: [id])
  teamId Int
  series Series? @relation(fields: [round, season, seriesCode], references: [round, season, seriesCode])
  round Int
  season String
  seriesCode String
  @@id([teamId, round, season, seriesCode])
}

// model Venue {
//   id        Int @id
//   name      String
//   link      String
//   teams     Team[]     
// }